def strip_comments(sql_text: str) -> str:
    cleaned_lines = []
    for line in sql_text.splitlines():
        stripped = line.strip()
        # Skip full-line comments
        if stripped.startswith('--'):
            continue
        cleaned_lines.append(line)
    return '\n'.join(cleaned_lines)


for f in files:
    print(f'--- Executing file: {f}')
    with open(f, 'r', encoding='utf-8') as fh:
        raw_sql = fh.read()

    cleaned_sql = strip_comments(raw_sql)

    if cleaned_sql.strip():
        ctx.execute_string(cleaned_sql)
